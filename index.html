<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Mis XV ‚Äì Memories</title>

<meta name="theme-color" content="#0e0f12" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="apple-mobile-web-app-title" content="Mis XV ‚Äì Memories" />

<style>
  /* üé® Conserv√© todos tus estilos originales */
  :root{ --bg:#0e0f12; --card:#14161c; --muted:#b7becb;
         --copper1:#a66a54; --copper2:#d19a7d; --emerald:#22c3a6;
         --glass:rgba(255,255,255,.06); --radius:18px; }
  *{box-sizing:border-box} html,body{height:100%}
  body{ margin:0; color:#f7f9fc; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
        background: radial-gradient(1200px 600px at 50% -10%, #1b202a 0, var(--bg) 60%); overflow-x:hidden; }
  /* ... (dejo tus estilos intactos para hero, uploader, dedicatorias, etc.) ... */

  /* Bot√≥n flotante m√∫sica */
  .music-btn {
    position:fixed; bottom:20px; right:20px; z-index:90;
    background:#22c3a6; color:#000; border-radius:50%;
    width:56px; height:56px; display:flex; align-items:center; justify-content:center;
    font-size:22px; cursor:pointer; box-shadow:0 6px 16px rgba(0,0,0,.4);
  }
</style>
</head>
<body>
  <!-- Hero y todo tu dise√±o original aqu√≠ -->

  <!-- Galer√≠a -->
  <section>
    <h3 class="section-title">Galer√≠a completa</h3>
    <div class="gallery" id="gallery"></div>
    <div class="note" id="emptyMsg" style="display:none">A√∫n no hay recuerdos visibles.</div>
  </section>

  <!-- Dedicatorias -->
  <section id="dedicatorias" class="dedi">
    <h3 class="section-title" style="margin-top:0">Dedicatorias</h3>
    <form id="dediForm">
      <input id="dediNombre" placeholder="Tu nombre" required />
      <textarea id="dediMsg" placeholder="Escribe tu mensaje para CYTLALLI" required></textarea>
      <div class="dedi-actions">
        <button type="submit" class="btn">Enviar dedicatoria</button>
        <button type="button" id="toggleList" class="btn" style="background:linear-gradient(90deg,#41dfc6,#72ffe8)">üëÄ Ver dedicatorias</button>
        <button type="button" id="downloadDedis" class="btn" style="background:#2feaa0">‚¨áÔ∏è Descargar dedicatorias</button>
      </div>
    </form>
    <div class="dedi-list" id="dediList" style="display:none"></div>
    <div class="note">Las dedicatorias se guardan en la nube y se muestran abajo.</div>
  </section>

  <!-- Bot√≥n flotante m√∫sica -->
  <div id="musicBtn" class="music-btn">‚ñ∂Ô∏è</div>
  <audio id="bgmusic" loop>
    <source src="https://script.google.com/macros/s/AKfycbxp09tad2Jj4_yVEuEG6TKM2n4rCCVTM6KtANJlkp3AABifAhfZvuRGMsRr3rsiOL4/exec?action=audio" type="audio/mpeg">
  </audio>

  <script>
  /* ===== CONFIG ===== */
  const API_URL = "https://script.google.com/macros/s/AKfycbxp09tad2Jj4_yVEuEG6TKM2n4rCCVTM6KtANJlkp3AABifAhfZvuRGMsRr3rsiOL4/exec";
  const gallery = document.getElementById('gallery');
  const dediForm = document.getElementById('dediForm');
  const dediList = document.getElementById('dediList');

  /* ===== Cargar galer√≠a ===== */
  async function loadGallery(){
    const res = await fetch(API_URL + "?action=files");
    const data = await res.json();
    gallery.innerHTML = "";
    if(data.ok){
      data.files.forEach(f=>{
        const card = document.createElement('div');
        card.className="card";
        if(f.mimeType.startsWith("video/")){
          const v=document.createElement('video');
          v.src=`https://drive.google.com/uc?export=download&id=${f.id}`;
          v.controls=true;
          card.appendChild(v);
        }else{
          const img=document.createElement('img');
          img.loading="lazy"; img.decoding="async";
          img.src=`https://drive.google.com/uc?export=view&id=${f.id}`;
          card.appendChild(img);
        }
        gallery.appendChild(card);
      });
    }
  }

  /* ===== Dedicatorias ===== */
  dediForm.onsubmit=async(e)=>{
    e.preventDefault();
    const nombre=document.getElementById('dediNombre').value;
    const mensaje=document.getElementById('dediMsg').value;
    await fetch(API_URL,{method:"POST",body:JSON.stringify({dedi:{nombre,mensaje}})});
    document.getElementById('dediNombre').value="";
    document.getElementById('dediMsg').value="";
    loadDedis();
  };

  async function loadDedis(){
    const res=await fetch(API_URL+"?action=dedis");
    const data=await res.json();
    dediList.innerHTML="";
    if(data.ok){
      data.dedis.forEach(d=>{
        const item=document.createElement('div');
        item.className="dedi-item";
        item.innerHTML=`<strong>${d.nombre}</strong><br>${d.mensaje}<br><small>${d.fecha}</small>`;
        const hide=document.createElement('button');
        hide.className="hideBtn"; hide.textContent="√ó";
        hide.onclick=()=>item.remove();
        item.appendChild(hide);
        dediList.appendChild(item);
      });
    }
  }

  document.getElementById('toggleList').onclick=()=>{
    dediList.style.display = (dediList.style.display==="none")?"block":"none";
    if(dediList.style.display==="block") loadDedis();
  };

  document.getElementById('downloadDedis').onclick=()=>{
    window.open(API_URL+"?action=dedis","_blank");
  };

  /* ===== M√∫sica ===== */
  const musicBtn=document.getElementById('musicBtn');
  const bgmusic=document.getElementById('bgmusic');
  let playing=false;
  musicBtn.onclick=()=>{
    if(!playing){ bgmusic.play(); musicBtn.textContent="‚è∏Ô∏è"; playing=true; }
    else{ bgmusic.pause(); musicBtn.textContent="‚ñ∂Ô∏è"; playing=false; }
  };

  /* ===== Init ===== */
  loadGallery();
  </script>
</body>
</html>
